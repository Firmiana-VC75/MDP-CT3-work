<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Great Paintings in the World</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
     <header>
        <h1>Art Generator</h1>
        <h3>Start here:</h3>
        <button id="fetch-button">Get your artwork</button>
    </header>
 <main id="main-content">
    </main>
    <script>
        const triggerButton = document.getElementById('fetch-button');
        const mainContent = document.getElementById('main-content');

         const fetchArtworkData = () => {
         const artworkIds = [436535, 438817, 459055, 437853, 435844];
         const randomId = artworkIds[Math.floor(Math.random() * artworkIds.length)];
    
         fetch(`https://collectionapi.metmuseum.org/public/collection/v1/objects/${randomId}`)
         .then(response => response.json())
         .then((data) => appendArtworkData(data, false))
        }

        const fetchHistoryData = (month, day) => {
            fetch(`https://en.wikipedia.org/api/rest_v1/feed/onthisday/all/${month}/${day}`)
            .then(response => response.json())
            .then((data) => appendHistoryData(data))
        }

        const appendArtworkData = (data, logData = true) => {
            if(logData) console.log(data)
                    
                    let artworkName = data.title
                        let artworkImage = data.primaryImage
                        let artworkArtist = data.artistDisplayName
                        let artworkDate = data.objectDate
                        let artworkMedium = data.medium

                        let artworkHTML = `
                        <h2>${artworkName}</h2>
                        <img src="${artworkImage}" alt="${artworkName}" id="artwork-img"/>
                        <p>Artist: ${artworkArtist}</p>
                        <p>Date: ${artworkDate}</p>
                        <p>Medium: ${artworkMedium}</p>
                        `
                        mainContent.innerHTML = artworkHTML
                    }

                    const year = extractYear(artworkDate)
                    const randomMonth = Math.floor(Math.random() * 12) + 1
                    const randomDay = Math.floor(Math.random() * 29) + 1

                    fetchHistoryData(randomMonth, randomDay)
                    const extractYear = (dateString) => {
                        if (!dateString) return null
                        const match = dateString.match(/\b(1[0-9]{3}|20[0-9]{2})\b/)
                        return match ? match[0] : null
                    }

                    const appendHistoryData = (data) => {
                        console.log(data)
                        const events = data.events
                        const displayEvents = events.slice(0, 3)
                    }

                    let historyHTML = `
                     <h3>Historical Story</h3>
                     <p>Events from history on this day:</p>
                     `

                     displayEvents.forEach(event => {
                        historyHTML += `
                        <p><strong>${event.year}</strong> - ${event.text}</p>
                        `
                        mainContent.innerHTML += historyHTML

                    })
                    
                    triggerButton.addEventListener('click', fetchArtworkData)
                </script>
</body>
</html>